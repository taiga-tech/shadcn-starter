# 重要なデバッグ記録

## セットアップ関連

### pnpm関連の問題

- **問題**: `pnpm install`の依存関係解決エラー
- **原因**: workspace:\*パターンの循環依存
- **解決策**: `pnpm clean-install`スクリプトの使用
- **再発防止**: 新しいパッケージ追加時のworkspace依存関係チェック

### Turbo関連の問題

- **問題**: ビルドキャッシュの不整合
- **症状**: 変更が反映されない
- **解決策**: `turbo clean`でキャッシュクリア
- **再発防止**: 大きな変更後のキャッシュクリア習慣化

## テスト関連

### E2Eテストの前提条件

- **問題**: Playwrightテストが失敗
- **原因**: ビルドされていない状態でのテスト実行
- **解決策**: `pnpm build`の事前実行必須
- **教訓**: E2Eテストは必ずビルド後に実行

### 型エラーとテストの関係

- **問題**: テスト実行時の型エラー
- **原因**: TypeScript設定の不整合
- **解決策**: `pnpm check-types`での事前確認
- **教訓**: 型エラーは作業完了前に必ず解決

## 開発環境関連

### Next.js 15の互換性

- **問題**: 一部ライブラリとの互換性問題
- **対策**: package.jsonでの明示的なバージョン指定
- **監視**: React 19との組み合わせでの動作確認

### shadcn/uiコンポーネント

- **問題**: コンポーネントの重複インストール
- **原因**: `-c apps/web`オプションの理解不足
- **解決策**: コンポーネントは packages/ui に一元配置
- **教訓**: shadcnコマンドの正確な理解が重要

## パフォーマンス関連

### バンドルサイズの問題

- **監視項目**: Analyze結果での不要な依存関係
- **対策**: Tree-shakingの確認
- **ツール**: `ANALYZE=true pnpm build`での定期チェック

### 開発サーバーの応答性

- **問題**: HMRの遅延
- **対策**: Turbopackの活用
- **監視**: ファイル変更から反映までの時間

## 本番環境関連

### ビルド時の注意点

- **チェック項目**:
    - 型エラー: `pnpm check-types`
    - ESLintエラー: `pnpm lint`
    - テスト: `pnpm test:all`
- **順序**: 型チェック → lint → テスト → ビルド

### 環境変数の管理

- **注意**: .env\*ファイルの適切な配置
- **確認**: turbo.jsonでの環境変数定義
- **セキュリティ**: 機密情報の適切な管理
